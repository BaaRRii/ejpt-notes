
Post-Exploitation

- Introduction to Post-Exploitation
    - Consists of the tactics, techniques, procedures after obtaining initial access on a target system
    - Will differ based on the target operating system as well as the target infraestructure

- Post-Exploitation methodology
    - Phases:
        1. Local Enumeration
        2. Transferring files
        3. Upgrading shells
        4. Privilege Escalation
        5. Persistence
        6. Dumping & cracking hashes
        7. Pivoting
        8. Clearing Tracks

Windows Local Enumeration

- Enumerating Sytem Information
    - What are we looking for:
        - Hostname
        - OS Name
        - OS Build & Service Pack
        - OS Architecture
        - Installed updates & hotfixes
    - Shell
        - hostname 
        - systeminfo
        - wmic qfe get Caption,Description,HotFixID,InstalledOn
        - C:\\Windows\System32\eula.txt (version, build, etc)

- Enumerating Users & Groups
    - What are we looking for:
        - Current user & privileges
        - Additional user information
        - Other users on the system
        - Groups
        - Members of the built-in administrator group
    - Meterpreter
        - getuid
        - getprivs
        - module logged_on
    - Shell
        - whoami
        - whoami /priv
        - query user 
        - net users 
        - net user administrator 
        - net localgroup
        - net localgroup administrators

- Enumerating Network Information
    - What are we looking for:
        - Current IP addresses & network adapters
        - Internal networks
        - TCP/UDP running 
        - Other hosts in the network
        - Routing table 
        - Windows Firewall state
    - Shell
        - ipconfig
        - route print 
        - arp -a 
        - netstat -ano 
        - netsh firewall show state
        - netsh advfirewall firewall show state 

- Enumerating processes and services
    - What are we looking for:
        - Running processes & services-
        - Scheduled tasks
    - A process os an instance of a running executable or program 
    - A service is a process which runs in the background and does not interact with the desktop 
    - Meterpreter:
        - ps 
    - Shell:
        - net start 
        - wmic service list brief
        - tasklist /SVC
        - schtasks /query /fo LIST v

- Automating Windows Local Enumeration
    - We can automate the process with metasploit modules
    - JAWS: Just Another Windows Enum Script (https://github.com/411Hall/JAWS)
    - Meterpreter
        - gather/win_privs module 
        - gather/checkvm module 
        - gather/enum_applications module 
        - gather/enum_computers module 
        - gather/enum_patches module 
        - gather/enum_shares module 
    - Shell
        - powershell.exe -ExecutionPolicy Bypass -File .\jaws.psl -OutputFilename JAWS-enum.txt
   